SQL exos

A- Structure analysis
1- Employees table structure
2- Departments tablestructure

B- Basic selection
1- all the employees:
	SELECT `first_name`, `last_name` FROM `employees`

2- all the departments
	SELECT * FROM `departments`

3- the name and lastname of  all the employees  hired after 01/01/1990
	SELECT `first_name`,`last_name`,`hire_date` FROM `employees` WHERE `hire_date`< ('1990-01-01')

4- The name and last name of all the female employees.
	SELECT `first_name`,`last_name`,`gender` FROM `employees` WHERE `gender`= 'F'


C- Inner joins using from and where

1- select the name, lastname, and  department of all the employees hired in between 1990-01-01 and 1997-12-31. // hint look for the BETWEEN AND operator in sql documentation
	SELECT e.`emp_no`,`first_name`,`last_name`,`hire_date`, d.`dept_no`,`dept_name` 
	FROM `employees` e,`departments` d,`dept_emp`de 
	WHERE e.`emp_no`= de.`emp_no` AND d.`dept_no`= de.`dept_no` AND `hire_date` BETWEEN '1990-01-01' AND '1997-12-31' 
	ORDER BY `emp_no` LIMIT 1,30
/* interval value used BETWEEN AND */

  
2- select femal employee, last name, name and last salary of each employee. Ordered by hired date descending. // hint look for the ASC/DESC for the Order by clause.
	SELECT `last_name`,`first_name`,`salary`
	FROM `employees` e, `salaries` s
	WHERE e.`emp_no` > 100000 AND `to_date`= '9999-01-01' AND e.`emp_no`= s.`emp_no`
	ORDER BY `hire_date` DESC
    	LIMIT 1,30;
/* emp_no> 100000 used in condition to exinclud the amount of employees, for reducing the searching timeframe */


3- Gathers amount of employees. // hint function count
	SELECT COUNT(`emp_no`) FROM `employees`

 
3- select last name, name and salary of all the employees that are now in the deparment d005 or in the department d007 or in the department d003.  Ordered by salary ascending. // HINT look for the IN operator.
	SELECT `last_name`,`first_name`,`salary`,`dept_no`,`dept_name` 
	FROM `employees`e, `salaries`s, `departments`d 
	WHERE `to_date`= '9999-01-01' AND `dept_no` IN ('d003', 'd005', 'd007') AND e.`emp_no`= s.`emp_no` 
	ORDER BY `salary` ASC
/* looking specific a set of value use IN, otherwise use = */


4- select all the employees that are Senior engineers.
	SELECT e.`emp_no`, `first_name`, `last_name`, `title`, `gender`
	FROM `employees`e ,`titles`t 
	WHERE `title`= 'Senior Engineer' AND e.`emp_no`= t.`emp_no`
	ORDER BY `gender`;


5- select a full employee information for the employees in the department d005.
	SELECT *
	FROM `employees`e, `departments`d, `dept_emp`de, salaries s, titles t
	WHERE  
       		d.`dept_no`= 'd005' AND 
	  	e.`emp_no`= de.`emp_no` AND 
       		d.`dept_no`=de.`dept_no`AND 	
		s.emp_no = e.emp_no AND 
       		s.to_date = de.to_date AND 
       		s.to_date = '9999-01-01' AND
       		t.emp_no = e.emp_no
		LIMIT 0,30
/* iterative testing: adding tabels after each run */
       

D- Functions 

1- select the name, lastname, and  department of all the employees hired in the years 1990 1985 and 1982. // Hint remember IN, look for the function YEAR.
	SELECT `first_name`, `last_name`, d.`dept_no`, d.`dept_name`, hire_date 
	FROM `employees`e, departments d, dept_emp de 
	WHERE year (hire_date) IN (1990, 1985, 1982) AND d.dept_no = de.dept_no AND e.emp_no = de.emp_no

/* to use funciton YEAR then IN for extract date to demand format*/

      
2- select all the months where some employee has been hired. // HINT look for MONTH function and DISTINCT clause // select distinct
	SELECT DISTINCT month (hire_date ) FROM `employees`
/*SELECT DISTINCT YEAR(date_added) AS "Year", MONTH(date_added) AS "Month" FROM payments*/

3- select "title, lastname, name", year hired, deparment name, bosses "lastname, name", last salary,  employee information for the employee 10001. // HINT look for CONCAT function. 
SELECT title, 
       CONCAT(e.`last_name`,', ', e.`first_name`) FullName, 
       dept_name Department, 
       year(`hire_date`) Year, 
       salary, 
	   (SELECT m.last_name 
        FROM employees m 
        WHERE m.emp_no = dm.emp_no) manager
FROM titles t, `employees` e, departments d, salaries s, dept_emp de, dept_manager dm
WHERE e.emp_no =10001 AND
	  s.to_date = '9999-01-01' AND
      s.emp_no = e.emp_no AND

      t.emp_no = e.emp_no AND
      t.to_date = s.to_date AND

      de.emp_no = e.emp_no AND
      de.dept_no = d.dept_no AND
      de.to_date = s.to_date AND
      
      dm.dept_no = d.dept_no AND 
      dm.to_date = s.to_date AND 
            



